<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Exposing a local web server using Cloudflare Tunnels | Gauthier Jolly</title><meta name=keywords content="Cloudflare"><meta name=description content="Make your local web server accessible from the internet using Cloudflare Tunnels"><meta name=author content="Gauthier Jolly"><link rel=canonical href=https://gjolly.fr/blog/cf-tunnels/><link crossorigin=anonymous href=https://gjolly.fr/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://gjolly.fr/img/terminal-sign.svg><link rel=icon type=image/png sizes=16x16 href=https://gjolly.fr/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://gjolly.fr/favicon-32x32.png><link rel=apple-touch-icon href=https://gjolly.fr/apple-touch-icon.png><link rel=mask-icon href=https://gjolly.fr/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://gjolly.fr/blog/cf-tunnels/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-Y4G50Q2695"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Y4G50Q2695")}</script><meta property="og:url" content="https://gjolly.fr/blog/cf-tunnels/"><meta property="og:site_name" content="Gauthier Jolly"><meta property="og:title" content="Exposing a local web server using Cloudflare Tunnels"><meta property="og:description" content="Make your local web server accessible from the internet using Cloudflare Tunnels"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2025-12-16T15:30:00+00:00"><meta property="article:modified_time" content="2025-12-16T15:30:00+00:00"><meta property="article:tag" content="Cloudflare"><meta name=twitter:card content="summary"><meta name=twitter:title content="Exposing a local web server using Cloudflare Tunnels"><meta name=twitter:description content="Make your local web server accessible from the internet using Cloudflare Tunnels"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://gjolly.fr/blog/"},{"@type":"ListItem","position":2,"name":"Exposing a local web server using Cloudflare Tunnels","item":"https://gjolly.fr/blog/cf-tunnels/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Exposing a local web server using Cloudflare Tunnels","name":"Exposing a local web server using Cloudflare Tunnels","description":"Make your local web server accessible from the internet using Cloudflare Tunnels","keywords":["Cloudflare"],"articleBody":"I often run into this problem: I have a local file on my computer that I want to share with a friend or colleague on the other side of the world. While I could upload it to a file sharing service, it’s can be very annoying to have to upload it somewhere first, especially if it’s a one-off situation and if the file is big. More over, it’s my data and I don’t necessarily want to upload it to a Google or Dropbox server. Similarly, when I’m developing a web application on my local machine, I often want to show it to someone else for testing or feedback. Again, uploading it to a public server can be cumbersome and I don’t want to start dealing with a deployment strategy if I just stated prototyping.\nIf you ran into similar situations, you might have heard of ngrok, a popular tool to expose local servers to the internet. However, ngrok’s free tier is quite limited and requires you to trust a third party service with your data.\nAn alternative to ngrok is Cloudflare Tunnels, a service provided by Cloudflare that allows you to securely expose your local web server to the internet without having to open any ports on your router or firewall. The best part is that it’s free for personal use and you can use it with your own domain name if you have one already registered with Cloudflare.\nWhat you “just” need is:\nA Cloudflare account. You can sign up for a free account here. A domain name registered with Cloudflare (optional, but recommended if you want to use your own domain name). A local web server running on your machine. This can be anything from a simple static file server to a complex web application. eg, a Python server running on 8000: 1 python3 -m http.server 8000 Docker installed on your machine. You can find installation instructions here. For the rest, I’ve made a script for myself (and for you) that automates everything. Save this script bellow as create-tunnel.sh, make it executable with chmod +x create-tunnel.sh, and run it with the local URL of your web server as an argument:\n1 ./create-tunnel.sh http://localhost:8000 Voila! But be careful: now anyone who visits https://tunnel.your-domain.com will be able to access your local web server. Since domain names are public, make sure you don’t use sensitive information in the URL. If you want to stop sharing your server, just kill the script (Ctrl+C) and the tunnel will be closed.\ncreate-tunnel.sh 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 #!/bin/bash -eu # Create and run a Cloudflare tunnel using Docker. # Usage: ./create-tunnel.sh # Check if docker is available if ! command -v docker \u003e /dev/null; then echo \"please install docker\" exit 1 fi url=\"$1\" # TODO: make this configurable domain=tunnel # Generate a unique tunnel name based on the machine ID # to avoid name collisions in case this script is run # on multiple machines. tunnel_name=app-$(cat /etc/machine-id) config_directory=\"$HOME/.config/tunnel\" mkdir -p \"$config_directory\" CLOUDFLARED=( docker run --rm --network host --name cloudflared --user 0 -v \"$config_directory:/root/.cloudflared\" cloudflare/cloudflared:latest ) # The first time we run this, we need to login to Cloudflare # to authorize the tunnel. if [ ! -f \"${config_directory}/cert.pem\" ]; then \"${CLOUDFLARED[@]}\" tunnel login fi tunnel_id=\"$(\"${CLOUDFLARED[@]}\" tunnel list \\ --output json \\ | jq -r \".[] | select(.name == \\\"${tunnel_name}\\\") | .id\")\" # Create the tunnel if it doesn't already exist # There might be a problem if the tunnel was created but the config file # is missing, but let's not worry about that for now. if [ -z \"${tunnel_id}\" ] || [ ! -f \"${config_directory}/${tunnel_id}.json\" ]; then \"${CLOUDFLARED[@]}\" tunnel create \"$tunnel_name\" tunnel_id=\"$(\"${CLOUDFLARED[@]}\" tunnel list \\ --output json \\ | jq -r \".[] | select(.name == \\\"${tunnel_name}\\\") | .id\")\" fi # This will just do nothing if the DNS record already exists \"${CLOUDFLARED[@]}\" tunnel route dns \"$tunnel_name\" \"$domain\" # Finally, run the tunnel \"${CLOUDFLARED[@]}\" \\ --loglevel info \\ tunnel run \\ --url \"$url\" \\ --credentials-file \"/root/.cloudflared/${tunnel_id}.json\" \\ \"$tunnel_name\" ","wordCount":"722","inLanguage":"en","datePublished":"2025-12-16T15:30:00Z","dateModified":"2025-12-16T15:30:00Z","author":{"@type":"Person","name":"Gauthier Jolly"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://gjolly.fr/blog/cf-tunnels/"},"publisher":{"@type":"Organization","name":"Gauthier Jolly","logo":{"@type":"ImageObject","url":"https://gjolly.fr/img/terminal-sign.svg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://gjolly.fr/ accesskey=h title="Home (Alt + H)"><img src=https://gjolly.fr/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://gjolly.fr/blog/ title=blog><span>blog</span></a></li><li><a href=https://gjolly.fr/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://gjolly.fr/>Home</a>&nbsp;»&nbsp;<a href=https://gjolly.fr/blog/>Blogs</a></div><h1 class="post-title entry-hint-parent">Exposing a local web server using Cloudflare Tunnels</h1><div class=post-description>Make your local web server accessible from the internet using Cloudflare Tunnels</div><div class=post-meta><span title='2025-12-16 15:30:00 +0000 UTC'>December 16, 2025</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Gauthier Jolly</div></header><div class=post-content><p>I often run into this problem: I have a local file on my computer that I want to share with a friend or colleague on the other side of the world. While I could upload it to a file sharing service, it&rsquo;s can be very annoying to have to upload it somewhere first, especially if it&rsquo;s a one-off situation and if the file is big. More over, it&rsquo;s my data and I don&rsquo;t necessarily want to upload it to a Google or Dropbox server.
Similarly, when I&rsquo;m developing a web application on my local machine, I often want to show it to someone else for testing or feedback. Again, uploading it to a public server can be cumbersome and I don&rsquo;t want to start dealing with a deployment strategy if I just stated prototyping.</p><p>If you ran into similar situations, you might have heard of <a href=https://ngrok.com/>ngrok</a>, a popular tool to expose local servers to the internet. However, ngrok&rsquo;s free tier is quite limited and requires you to trust a third party service with your data.</p><p>An alternative to ngrok is <a href=https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/>Cloudflare Tunnels</a>, a service provided by Cloudflare that allows you to securely expose your local web server to the internet without having to open any ports on your router or firewall. The best part is that it&rsquo;s free for personal use and you can use it with your own domain name if you have one already registered with Cloudflare.</p><p>What you &ldquo;just&rdquo; need is:</p><ul><li>A Cloudflare account. You can sign up for a free account <a href=https://www.cloudflare.com/>here</a>.</li><li>A domain name registered with Cloudflare (optional, but recommended if you want to use your own domain name).</li><li>A local web server running on your machine. This can be anything from a simple static file server to a complex web application. eg, a Python server running on <code>8000</code>:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 -m http.server <span class=m>8000</span>
</span></span></code></pre></td></tr></table></div></div></li><li>Docker installed on your machine. You can find installation instructions <a href=https://docs.docker.com/get-docker/>here</a>.</li></ul><p>For the rest, I&rsquo;ve made a script for myself (and for you) that automates everything. Save this script bellow as <code>create-tunnel.sh</code>, make it executable with <code>chmod +x create-tunnel.sh</code>, and run it with the local URL of your web server as an argument:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./create-tunnel.sh http://localhost:8000
</span></span></code></pre></td></tr></table></div></div><p>Voila! But be careful: now anyone who visits <code>https://tunnel.your-domain.com</code> will be able to access your local web server. Since domain names are public, make sure you don&rsquo;t use sensitive information in the URL. If you want to stop sharing your server, just kill the script (Ctrl+C) and the tunnel will be closed.</p><h2 id=create-tunnelsh>create-tunnel.sh<a hidden class=anchor aria-hidden=true href=#create-tunnelsh>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span><span class=lnt id=hl-2-22><a class=lnlinks href=#hl-2-22>22</a>
</span><span class=lnt id=hl-2-23><a class=lnlinks href=#hl-2-23>23</a>
</span><span class=lnt id=hl-2-24><a class=lnlinks href=#hl-2-24>24</a>
</span><span class=lnt id=hl-2-25><a class=lnlinks href=#hl-2-25>25</a>
</span><span class=lnt id=hl-2-26><a class=lnlinks href=#hl-2-26>26</a>
</span><span class=lnt id=hl-2-27><a class=lnlinks href=#hl-2-27>27</a>
</span><span class=lnt id=hl-2-28><a class=lnlinks href=#hl-2-28>28</a>
</span><span class=lnt id=hl-2-29><a class=lnlinks href=#hl-2-29>29</a>
</span><span class=lnt id=hl-2-30><a class=lnlinks href=#hl-2-30>30</a>
</span><span class=lnt id=hl-2-31><a class=lnlinks href=#hl-2-31>31</a>
</span><span class=lnt id=hl-2-32><a class=lnlinks href=#hl-2-32>32</a>
</span><span class=lnt id=hl-2-33><a class=lnlinks href=#hl-2-33>33</a>
</span><span class=lnt id=hl-2-34><a class=lnlinks href=#hl-2-34>34</a>
</span><span class=lnt id=hl-2-35><a class=lnlinks href=#hl-2-35>35</a>
</span><span class=lnt id=hl-2-36><a class=lnlinks href=#hl-2-36>36</a>
</span><span class=lnt id=hl-2-37><a class=lnlinks href=#hl-2-37>37</a>
</span><span class=lnt id=hl-2-38><a class=lnlinks href=#hl-2-38>38</a>
</span><span class=lnt id=hl-2-39><a class=lnlinks href=#hl-2-39>39</a>
</span><span class=lnt id=hl-2-40><a class=lnlinks href=#hl-2-40>40</a>
</span><span class=lnt id=hl-2-41><a class=lnlinks href=#hl-2-41>41</a>
</span><span class=lnt id=hl-2-42><a class=lnlinks href=#hl-2-42>42</a>
</span><span class=lnt id=hl-2-43><a class=lnlinks href=#hl-2-43>43</a>
</span><span class=lnt id=hl-2-44><a class=lnlinks href=#hl-2-44>44</a>
</span><span class=lnt id=hl-2-45><a class=lnlinks href=#hl-2-45>45</a>
</span><span class=lnt id=hl-2-46><a class=lnlinks href=#hl-2-46>46</a>
</span><span class=lnt id=hl-2-47><a class=lnlinks href=#hl-2-47>47</a>
</span><span class=lnt id=hl-2-48><a class=lnlinks href=#hl-2-48>48</a>
</span><span class=lnt id=hl-2-49><a class=lnlinks href=#hl-2-49>49</a>
</span><span class=lnt id=hl-2-50><a class=lnlinks href=#hl-2-50>50</a>
</span><span class=lnt id=hl-2-51><a class=lnlinks href=#hl-2-51>51</a>
</span><span class=lnt id=hl-2-52><a class=lnlinks href=#hl-2-52>52</a>
</span><span class=lnt id=hl-2-53><a class=lnlinks href=#hl-2-53>53</a>
</span><span class=lnt id=hl-2-54><a class=lnlinks href=#hl-2-54>54</a>
</span><span class=lnt id=hl-2-55><a class=lnlinks href=#hl-2-55>55</a>
</span><span class=lnt id=hl-2-56><a class=lnlinks href=#hl-2-56>56</a>
</span><span class=lnt id=hl-2-57><a class=lnlinks href=#hl-2-57>57</a>
</span><span class=lnt id=hl-2-58><a class=lnlinks href=#hl-2-58>58</a>
</span><span class=lnt id=hl-2-59><a class=lnlinks href=#hl-2-59>59</a>
</span><span class=lnt id=hl-2-60><a class=lnlinks href=#hl-2-60>60</a>
</span><span class=lnt id=hl-2-61><a class=lnlinks href=#hl-2-61>61</a>
</span><span class=lnt id=hl-2-62><a class=lnlinks href=#hl-2-62>62</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash -eu
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># Create and run a Cloudflare tunnel using Docker.</span>
</span></span><span class=line><span class=cl><span class=c1># Usage: ./create-tunnel.sh &lt;local-url&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check if docker is available</span>
</span></span><span class=line><span class=cl><span class=k>if</span> ! <span class=nb>command</span> -v docker &gt; /dev/null<span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;please install docker&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>url</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># TODO: make this configurable</span>
</span></span><span class=line><span class=cl><span class=nv>domain</span><span class=o>=</span>tunnel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Generate a unique tunnel name based on the machine ID</span>
</span></span><span class=line><span class=cl><span class=c1># to avoid name collisions in case this script is run</span>
</span></span><span class=line><span class=cl><span class=c1># on multiple machines.</span>
</span></span><span class=line><span class=cl><span class=nv>tunnel_name</span><span class=o>=</span>app-<span class=k>$(</span>cat /etc/machine-id<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>config_directory</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$HOME</span><span class=s2>/.config/tunnel&#34;</span>
</span></span><span class=line><span class=cl>mkdir -p <span class=s2>&#34;</span><span class=nv>$config_directory</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>CLOUDFLARED</span><span class=o>=(</span>
</span></span><span class=line><span class=cl>    docker run --rm
</span></span><span class=line><span class=cl>    --network host
</span></span><span class=line><span class=cl>    --name cloudflared
</span></span><span class=line><span class=cl>    --user <span class=m>0</span>
</span></span><span class=line><span class=cl>    -v <span class=s2>&#34;</span><span class=nv>$config_directory</span><span class=s2>:/root/.cloudflared&#34;</span>
</span></span><span class=line><span class=cl>    cloudflare/cloudflared:latest
</span></span><span class=line><span class=cl><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># The first time we run this, we need to login to Cloudflare</span>
</span></span><span class=line><span class=cl><span class=c1># to authorize the tunnel.</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> ! -f <span class=s2>&#34;</span><span class=si>${</span><span class=nv>config_directory</span><span class=si>}</span><span class=s2>/cert.pem&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;</span><span class=si>${</span><span class=nv>CLOUDFLARED</span><span class=p>[@]</span><span class=si>}</span><span class=s2>&#34;</span> tunnel login
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>tunnel_id</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>CLOUDFLARED</span><span class=p>[@]</span><span class=si>}</span><span class=s2>&#34;</span> tunnel list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>        --output json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>            <span class=p>|</span> jq -r <span class=s2>&#34;.[] | select(.name == \&#34;</span><span class=si>${</span><span class=nv>tunnel_name</span><span class=si>}</span><span class=s2>\&#34;) | .id&#34;</span><span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create the tunnel if it doesn&#39;t already exist</span>
</span></span><span class=line><span class=cl><span class=c1># There might be a problem if the tunnel was created but the config file</span>
</span></span><span class=line><span class=cl><span class=c1># is missing, but let&#39;s not worry about that for now.</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> -z <span class=s2>&#34;</span><span class=si>${</span><span class=nv>tunnel_id</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> ! -f <span class=s2>&#34;</span><span class=si>${</span><span class=nv>config_directory</span><span class=si>}</span><span class=s2>/</span><span class=si>${</span><span class=nv>tunnel_id</span><span class=si>}</span><span class=s2>.json&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;</span><span class=si>${</span><span class=nv>CLOUDFLARED</span><span class=p>[@]</span><span class=si>}</span><span class=s2>&#34;</span> tunnel create <span class=s2>&#34;</span><span class=nv>$tunnel_name</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>tunnel_id</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>CLOUDFLARED</span><span class=p>[@]</span><span class=si>}</span><span class=s2>&#34;</span> tunnel list <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>        --output json <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>            <span class=p>|</span> jq -r <span class=s2>&#34;.[] | select(.name == \&#34;</span><span class=si>${</span><span class=nv>tunnel_name</span><span class=si>}</span><span class=s2>\&#34;) | .id&#34;</span><span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># This will just do nothing if the DNS record already exists</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=si>${</span><span class=nv>CLOUDFLARED</span><span class=p>[@]</span><span class=si>}</span><span class=s2>&#34;</span> tunnel route dns <span class=s2>&#34;</span><span class=nv>$tunnel_name</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$domain</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Finally, run the tunnel</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=si>${</span><span class=nv>CLOUDFLARED</span><span class=p>[@]</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --loglevel info <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    tunnel run <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --url <span class=s2>&#34;</span><span class=nv>$url</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --credentials-file <span class=s2>&#34;/root/.cloudflared/</span><span class=si>${</span><span class=nv>tunnel_id</span><span class=si>}</span><span class=s2>.json&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=s2>&#34;</span><span class=nv>$tunnel_name</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://gjolly.fr/tags/cloudflare/>Cloudflare</a></li></ul><nav class=paginav><a class=next href=https://gjolly.fr/blog/llm-inference/><span class=title>Next »</span><br><span>Build an AI inference server on Ubuntu</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://gjolly.fr/>Gauthier Jolly</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>