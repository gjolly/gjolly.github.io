<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Firewall, Tailscale and Ubuntu | Gauthier Jolly</title>
<meta name=keywords content="Linux,Security,Ubuntu"><meta name=description content="How to configure Ubuntu's Firewall to allow SSH in with Tailscale"><meta name=author content="Gauthier Jolly"><link rel=canonical href=https://gjolly.fr/blog/ufw/><link crossorigin=anonymous href=https://gjolly.fr/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://gjolly.fr/img/terminal-sign.svg><link rel=icon type=image/png sizes=16x16 href=https://gjolly.fr/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://gjolly.fr/favicon-32x32.png><link rel=apple-touch-icon href=https://gjolly.fr/apple-touch-icon.png><link rel=mask-icon href=https://gjolly.fr/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://gjolly.fr/blog/ufw/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-Y4G50Q2695"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Y4G50Q2695")}</script><meta property="og:url" content="https://gjolly.fr/blog/ufw/"><meta property="og:site_name" content="Gauthier Jolly"><meta property="og:title" content="Firewall, Tailscale and Ubuntu"><meta property="og:description" content="How to configure Ubuntu's Firewall to allow SSH in with Tailscale"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-11-14T13:10:00+00:00"><meta property="article:modified_time" content="2021-11-14T13:10:00+00:00"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Security"><meta property="article:tag" content="Ubuntu"><meta name=twitter:card content="summary"><meta name=twitter:title content="Firewall, Tailscale and Ubuntu"><meta name=twitter:description content="How to configure Ubuntu's Firewall to allow SSH in with Tailscale"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://gjolly.fr/blog/"},{"@type":"ListItem","position":2,"name":"Firewall, Tailscale and Ubuntu","item":"https://gjolly.fr/blog/ufw/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Firewall, Tailscale and Ubuntu","name":"Firewall, Tailscale and Ubuntu","description":"How to configure Ubuntu's Firewall to allow SSH in with Tailscale","keywords":["Linux","Security","Ubuntu"],"articleBody":"I recently enabled the Firewall on my desktop on Ubuntu. I probably did a quick lookup online to find out that sudo ufw enable was enough to enable it. I entered the command and forgot about it.\n$ sudo ufw enable Firewall is active and enabled on system startup Obviously, (and to be honest I was waiting for it), it didn’t take long for things to go bad. A few weeks later, while I was not at home and wanted to SSH on my machine via tailscale, I realized that I couldn’t and quickly remember about the Firewall.\nQuick side note here: I configured sshd to only bind to the tailscale IP address. I don’t want to expose my desktop on the internet.\nUncomplicated FireWall ufw was introduced by Ubuntu to ease firewall configuration.\nOn Linux, “Firewalling” is usually done through the Netfilter subsystem which can be configured via the userspace tool nftables (successor of iptables). Because nftables is made to be very generic and provides a full interface for the Netfilter subsystem, while being very powerfull it is not easy to learn.\nufw is a simplified interface on top nftables. It helps the user to define simple Firewall rules.\nThis blog post describes basic use cases.\nAllow SSH on tailscale only A very cool feature of ufw is the notion of app. An app is defined by a config file stored in /etc/ufw/applications.d. Apps can be listed with ufw app list.\nOn my system I already had the OpenSSH app configured:\n$ cat /etc/ufw/applications.d/openssh-server [OpenSSH] title=Secure shell server, an rshd replacement description=OpenSSH is a free implementation of the Secure Shell protocol. ports=22/tcp Indeed, on Ubuntu, this configuration file is shipped with the openssh-server package. Now to enable OpenSSH on tailscale for both IPv4 and IPv6, I can simply run:\nsudo ufw allow in on tailscale0 from any to any app OpenSSH ","wordCount":"312","inLanguage":"en","datePublished":"2021-11-14T13:10:00Z","dateModified":"2021-11-14T13:10:00Z","author":{"@type":"Person","name":"Gauthier Jolly"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://gjolly.fr/blog/ufw/"},"publisher":{"@type":"Organization","name":"Gauthier Jolly","logo":{"@type":"ImageObject","url":"https://gjolly.fr/img/terminal-sign.svg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://gjolly.fr/ accesskey=h title="Home (Alt + H)"><img src=https://gjolly.fr/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://gjolly.fr/blog/ title=blog><span>blog</span></a></li><li><a href=https://gjolly.fr/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://gjolly.fr/>Home</a>&nbsp;»&nbsp;<a href=https://gjolly.fr/blog/>Blogs</a></div><h1 class="post-title entry-hint-parent">Firewall, Tailscale and Ubuntu</h1><div class=post-description>How to configure Ubuntu's Firewall to allow SSH in with Tailscale</div><div class=post-meta><span title='2021-11-14 13:10:00 +0000 UTC'>November 14, 2021</span>&nbsp;·&nbsp;312 words&nbsp;·&nbsp;Gauthier Jolly</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#uncomplicated-firewall>Uncomplicated FireWall</a></li><li><a href=#allow-ssh-on-tailscale-only>Allow SSH on tailscale only</a></li></ul></nav></div></details></div><div class=post-content><p>I recently enabled the Firewall on my desktop on Ubuntu. I probably did a quick lookup online to find out that <code>sudo ufw enable</code> was enough to enable it. I entered the command and forgot about it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo ufw <span class=nb>enable</span>
</span></span><span class=line><span class=cl>Firewall is active and enabled on system startup
</span></span></code></pre></div><p>Obviously, (and to be honest I was waiting for it), it didn&rsquo;t take long for things to go bad. A few weeks later, while I was not at home and wanted to SSH on my machine via <a href=https://tailscale.com/>tailscale</a>, I realized that I couldn&rsquo;t and quickly remember about the Firewall.</p><p>Quick side note here: I configured <code>sshd</code> to only bind to the tailscale IP address. I don&rsquo;t want to expose my desktop on the internet.</p><h2 id=uncomplicated-firewall>Uncomplicated FireWall<a hidden class=anchor aria-hidden=true href=#uncomplicated-firewall>#</a></h2><p><a href=https://wiki.ubuntu.com/UncomplicatedFirewall><code>ufw</code></a> was introduced by Ubuntu to ease firewall configuration.</p><p>On Linux, &ldquo;Firewalling&rdquo; is usually done through the <a href=https://www.netfilter.org/>Netfilter subsystem</a> which can be configured via the userspace tool <a href=https://www.netfilter.org/projects/nftables/index.html>nftables</a> (successor of <a href=https://www.netfilter.org/projects/iptables/index.html>iptables</a>). Because <code>nftables</code> is made to be very generic and provides a full interface for the Netfilter subsystem, while being very powerfull it is not easy to learn.</p><p><code>ufw</code> is a simplified interface on top <code>nftables</code>. It helps the user to define simple Firewall rules.</p><p>This <a href=https://discourse.ubuntu.com/t/security-firewall/11883>blog post</a> describes basic use cases.</p><h2 id=allow-ssh-on-tailscale-only>Allow SSH on tailscale only<a hidden class=anchor aria-hidden=true href=#allow-ssh-on-tailscale-only>#</a></h2><p>A very cool feature of <code>ufw</code> is the notion of <code>app</code>. An <code>app</code> is defined by a config file stored in <code>/etc/ufw/applications.d</code>. Apps can be listed with <code>ufw app list</code>.</p><p>On my system I already had the <code>OpenSSH</code> app configured:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat /etc/ufw/applications.d/openssh-server
</span></span><span class=line><span class=cl><span class=o>[</span>OpenSSH<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>title</span><span class=o>=</span>Secure shell server, an rshd replacement
</span></span><span class=line><span class=cl><span class=nv>description</span><span class=o>=</span>OpenSSH is a free implementation of the Secure Shell protocol.
</span></span><span class=line><span class=cl><span class=nv>ports</span><span class=o>=</span>22/tcp
</span></span></code></pre></div><p>Indeed, on Ubuntu, this configuration file is shipped with the <code>openssh-server</code> package. Now to enable <code>OpenSSH</code> on tailscale for both IPv4 and IPv6, I can simply run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw allow in on tailscale0 from any to any app OpenSSH
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://gjolly.fr/tags/linux/>Linux</a></li><li><a href=https://gjolly.fr/tags/security/>Security</a></li><li><a href=https://gjolly.fr/tags/ubuntu/>Ubuntu</a></li></ul><nav class=paginav><a class=prev href=https://gjolly.fr/blog/qemu_cheatsheet/><span class=title>« Prev</span><br><span>QEMU cheatsheet</span>
</a><a class=next href=https://gjolly.fr/blog/who/><span class=title>Next »</span><br><span>The UNIX `who` command</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://gjolly.fr/>Gauthier Jolly</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>